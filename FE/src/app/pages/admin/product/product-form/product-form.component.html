<div class="main-content">
  <div class="container-fluid">
    <div class="card custom-card">
      <mat-card-title class="text-center mt-3"
        ><span class="h2 font-weight-bold text-center"
          >Thêm sản phẩm</span
        ></mat-card-title>
      <div class="card-body">
        <mat-stepper linear #stepper>
          <mat-step [stepControl]="formGroup" [editable]="false">
            <form [formGroup]="formGroup">
              <ng-template matStepLabel>Thông tin sản phẩm</ng-template>
              <div class="row">
                <div class="col-3 p-0">
                  <div
                    class="custom-dropzone"
                    style="height: 360px; width: 234px;"
                    ngx-dropzone
                    [accept]="'image/*'"
                    (change)="onSelect($event)"
                  >
                    <ngx-dropzone-label>
                      <div>
                        <span>Chọn ảnh bìa!</span>
                      </div>
                    </ngx-dropzone-label>
                    <ngx-dropzone-image-preview
                      ngProjectAs="ngx-dropzone-preview"
                      *ngFor="let f of files"
                      [file]="f"
                      [removable]="true"
                      (removed)="onRemove(f)"
                    >
                      <ngx-dropzone-label> </ngx-dropzone-label>
                    </ngx-dropzone-image-preview>
                  </div>
                </div>
                <div class="col-9">
                  <mat-form-field appearance="outline">
                    <mat-label>Tên sản phẩm</mat-label>
                    <input matInput type="text" formControlName="name" required />
                    <mat-error class="text-danger"
                               *ngIf="formGroup.get('name')?.hasError('required') &&
                                      formGroup.get('name')?.touched">
                        Tên sản phẩm không được để trống!
                    </mat-error>
                    <mat-error class="text-danger"
                               *ngIf="formGroup.get('name')?.hasError('pattern') &&
                                      formGroup.get('name')?.touched">
                        Tên khách hàng không chứa ký tự đặc biệt
                    </mat-error>
                  </mat-form-field>
                  <mat-form-field appearance="outline" formGroupName="category">
                    <mat-label>Danh mục</mat-label>
                    <mat-select formControlName="id">
                      <mat-option
                        *ngFor="let item of categories"
                        [value]="item.id"
                      >
                        {{ item.name }}
                      </mat-option>
                    </mat-select>
                    <mat-error class="text-danger"
                               *ngIf="formGroup.get('category')?.hasError('required')">
                      Bạn chưa chọn danh mục sản phẩm!
                    </mat-error>
                  </mat-form-field>
                  <mat-form-field appearance="outline">
                    <mat-label>Giá</mat-label>
                    <input formControlName="price" matInput type="number" />
                    <mat-error class="text-danger"
                               *ngIf="formGroup.get('price')?.hasError('min') &&
                                      formGroup.get('price')?.touched">
                      Giá sản phẩm phải lớn hơn 0!
                    </mat-error>
                    <mat-error class="text-danger"
                               *ngIf="formGroup.get('price')?.hasError('required') &&
                                      formGroup.get('price')?.touched">
                      Giá sản phẩm không được để trống!
                    </mat-error>
                  </mat-form-field>
                  <mat-form-field appearance="outline">
                    <mat-label>Mô tả</mat-label>
                    <textarea formControlName="description" matInput id="floatingInput"></textarea>
                  </mat-form-field>
                  <div
                    class="d-flex justify-content-end align-items-end"
                    style="height: 100px"
                  >
                    <button
                      class="btn btn-info mt-auto"
                      mat-button
                      matStepperNext
                      (click)="createProduct()"
                    >
                      Đồng ý
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </mat-step>
          <mat-step [editable]="false">
              <ng-template matStepLabel>Ảnh sản phẩm</ng-template>
              <div class="row">
                <div class="col-12 p-0">
                  <!-- Image Product -->
                  <div
                    class="custom-dropzone"
                    style="height: 360px"
                    ngx-dropzone
                    [accept]="'image/*'"
                    (change)="onSelectDetail($event)"
                  >
                    <ngx-dropzone-label>
                      <div>
                        <span>Chọn ảnh sản phẩm!</span>
                      </div>
                    </ngx-dropzone-label>
                    <ngx-dropzone-image-preview
                      ngProjectAs="ngx-dropzone-preview"
                      *ngFor="let f of detailFiles"
                      [file]="f"
                      [removable]="true"
                      (removed)="onRemoveDetail(f)"
                    >
                      <ngx-dropzone-label>
                        <!-- Text content -->
                      </ngx-dropzone-label>
                    </ngx-dropzone-image-preview>
                  </div>
                </div>
                <div class="col-12 mt-3">
                  <div
                    class="d-flex justify-content-end align-items-end"
                  >
                    <button
                      class="btn btn-inverse"
                      mat-button
                      matStepperPrevious
                    >
                      Trở về
                    </button>
                    <button class="btn btn-info" mat-button matStepperNext>
                      Đồng ý
                    </button>
                  </div>
                </div>
              </div>
          </mat-step>
          <mat-step>
            <ng-template matStepLabel>Chuyển hướng</ng-template>
            <span class="h3 d-flex justify-content-center">
              Thêm mới sản phẩm thành công, chuyển đến trang thêm chi tiết!
            </span>
            <div class="d-flex justify-content-center">
              <button class="btn btn-inverse" mat-button matStepperPrevious>
                Trở về
              </button>
              <a routerLink="/productDetail" class="btn btn-info" mat-button>
                Tiếp theo
              </a>
            </div>
          </mat-step>
        </mat-stepper>
      </div>
    </div>
  </div>
</div>
